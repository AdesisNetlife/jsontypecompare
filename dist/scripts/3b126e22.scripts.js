"use strict";angular.module("JsontypecompareApp",["ngRoute","ngSanitize"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),function(a){a.module("JsontypecompareApp").controller("MainCtrl",["$scope","ComparatorSrv","ReporterSrv",function(a,b,c){function d(a){var b=String.fromCharCode(160),c=new RegExp(b,"g");return a.replace(c," ")}var e,f;a.pretty=!0,a.order=!0,a.validDocuments=!1,a.validLeftDocument=!1,a.validRightDocument=!1,a.prettifyLeft=function(){a.pretty&&e&&(a.order&&(e=c.sortProperties(e)),a.leftValue=JSON.stringify(e,!0,"  "))},a.prettifyRight=function(){a.pretty&&f&&(a.order&&(f=c.sortProperties(f)),a.rightValue=JSON.stringify(f,!0,"  "))},a.$watch("leftValue",function(b){if(e=null,a.validLeftDocument=!1,b){try{e=JSON.parse(d(b)),a.validLeftDocument=!0}catch(c){a.validLeftDocument=!1}a.validDocuments=a.validLeftDocument&&a.validRightDocument}}),a.$watch("rightValue",function(b){if(f=null,a.validRightDocument=!1,b){try{f=JSON.parse(d(b)),a.validRightDocument=!0}catch(c){a.validRightDocument=!1}a.validDocuments=a.validLeftDocument&&a.validRightDocument}}),a.compare=function(){a.comparison=b.compare(e,f),a.differences=c.generateDifferencesReport(a.comparison)}}])}(angular),function(a){a.module("JsontypecompareApp").directive("contenteditable",function(){return{require:"ngModel",link:function(a,b,c,d){b.on("blur",function(){a.$apply(function(){d.$setViewValue(b.html())})}),d.$render=function(a){b.html(a)},d.$setViewValue(b.text())}}})}(angular),function(a){function b(a,b){return"null"===a.type||"null"===b.type?!0:a.type===b.type}function c(a,b){return"null"===a.type?b.type:a.type}function d(a,c){return b(a,c)?g(a.properties,c.properties):{equal:!1,leftType:a.type,rightType:c.type}}var e,f,g,h,i;e=function(a){var b;for(b in a)if(a.hasOwnProperty(b)&&!a[b].equal)return!1;return!0},f=function(b,c){var d={type:"array"};return"mixed"===b.arrayType||"mixed"===c.arrayType?(d.leftArrayType=b.arrayType,d.rightArrayType=c.arrayType,d.equal=!1):b.arrayType===c.arrayType?(d.arrayType=b.arrayType,"object"===d.arrayType?a.extend(d,g(b.properties,c.properties)):d.equal=!0):"unknown"===b.arrayType?(d.arrayType=c.arrayType,d.equal=!0):"unknown"===c.arrayType?(d.arrayType=b.arrayType,d.equal=!0):(d.leftArrayType=b.arrayType,d.rightArrayType=c.arrayType,d.equal=!1),d},h=function(a,d,e){var h,i,j,k,l={};for(h in e)e.hasOwnProperty(h)&&(i=a[h],j=d[h],b(i,j)?(k=c(i,j),"object"===k?(l[h]=g(i.properties,j.properties),l[h].type="object"):"array"===k?l[h]=f(i,j):(l[h]=i,i.type=k,i.equal=!0)):l[h]={equal:!1,leftType:i.type,rightType:j.type});return l},i=function(a,b,c){var d,e={};for(d in b)b.hasOwnProperty(d)&&(a[d].equal=!1,a[d].missing=c,e[d]=a[d]);return e},g=function(b,c){var d,f={},g={},j={},k={};for(d in b)b.hasOwnProperty(d)&&(g[d]=!0);for(d in c)c.hasOwnProperty(d)&&(g[d]?(delete g[d],f[d]=!0):j[d]=!0);return a.extend(k,i(b,g,"right")),a.extend(k,i(c,j,"left")),a.extend(k,h(b,c,f)),{properties:k,equal:e(k)}},a.module("JsontypecompareApp").service("ComparatorSrv",["DescriptorSrv",function(a){this.compare=function(b,c){var e,f,g;return b===c?{equal:!0,same:!0}:null===b?{equal:!1,missing:"left"}:null===c?{equal:!1,missing:"right"}:(e=a.generateDescription(b),f=a.generateDescription(c),g=d(e,f))}}])}(angular),function(a){function b(a,b){return"null"===a?b:"null"===b?a:"mixed"}function c(b,c){var d;return d=null===b[c]?"null":a.isArray(b[c])?"array":typeof b[c]}var d,e,f,g,h,i;g=function(a){var c={};return a.forEach(function(a){var d,e=i(a);for(d in e)e.hasOwnProperty(d)&&(c[d]?c[d].type!==e[d].type&&(c[d].type=b(c[d].type,e[d].type)):c[d]=e[d])}),c},e=function(a){var b;for(b in a)if(a.hasOwnProperty(b)&&"mixed"===a[b].type)return!0;return!1},f=function(a){var b={};return a.forEach(function(a){var c=typeof a;b.arrayType?c!==b.arrayType&&(b.arrayType="mixed"):b.arrayType=c}),"object"===b.arrayType&&(b.properties=g(a),e(b.properties)&&(b.arrayType="mixed")),b.arrayType||(b.arrayType="unknown"),b},d=function(b,d){var e;return e={type:c(b,d)},"object"===e.type&&(e.properties=i(b[d])),"array"===e.type&&a.extend(e,f(b[d])),e},i=function(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=d(a,b));return c},h=function(b){if(a.isArray(b))return a.extend({type:"array"},f(b));var c,e={};for(c in b)b.hasOwnProperty(c)&&(e[c]=d(b,c));return{type:"object",properties:e}},a.module("JsontypecompareApp").service("DescriptorSrv",function(){this.generateDescription=h})}(angular),function(a){function b(a,b,c){var d={path:(c||"")+b};return a.type?a.missing?(d.errorType="missing",d.missing=a.missing):"array"===a.type?a.arrayType?d.errorType="children":(d.errorType="arrayType",d.leftArrayType=a.leftArrayType,d.rightArrayType=a.rightArrayType):d.errorType="children":(d.errorType="type",d.leftType=a.leftType,d.rightType=a.rightType),d}function c(a,b,c){var d=a||"";return d+=b,"array"===c.type&&(d+="[]"),d+="."}function d(a,e,f){var g,h,i;if(!e.equal){h=e.properties;for(g in h)h.hasOwnProperty(g)&&(h[g].equal||(a.push(b(h[g],g,f)),i=c(f,g,h[g]),d(a,h[g],i)))}}function e(a){var b=[];return d(b,a),b}function f(a){var b;for(b=0;b<a.length;b+=1)a[b]&&(a[b]=h(a[b]));return a}function g(a){var b,c,d,e=[],f={};for(c in a)a.hasOwnProperty(c)&&e.push(c);for(e.sort(),b=0;b<e.length;b+=1)d=a[e[b]],f[e[b]]="object"==typeof d?h(d):d;return f}function h(b){return a.isArray(b)?f(b):"object"==typeof b?g(b):b}a.module("JsontypecompareApp").service("ReporterSrv",function(){this.generateDifferencesReport=e,this.sortProperties=h})}(angular),function(a){a.module("JsontypecompareApp").filter("markerrors",function(){return function(a){var b,c='"equal": false',d=new RegExp(c,"g");return a&&(b=a.replace(d,'<span class="error">'+c+"</span>")),b}})}(angular);